<?xml version="1.0" encoding="UTF-8"?>
<project name="LOLEMSOperateWebtest" basedir="." default="all">
	
	<tstamp>
		<format property="m_version" pattern="yyyy-MM-dd_hh:mm:ss" />
	</tstamp>

	<property name="version" value="1.0.${m_version}" />
	
	<property name="WebSource" value="" />
	<property name="build" value="./build" />
	<property name="build.home" value="/root/.jenkins/workspace/LOLEMSOperateWebtest/build/*" />
	
	<property name="target" value="/u01/tomcatemstest/webapps/ROOT/operate" />

	<target name="all">
		<antcall target="clean" />
		<antcall target="creat" />
		<antcall target="copy" />
		<antcall target="copy2target" />
	</target>

	<target name="clean">
		<echo message="clean target files：${build} and ${target}" />
		<delete dir="${build}" />
		<sshexec host="10.163.243.179" port="22" username="root" password="Baiqi@Linux" command="cd ${target};rm -rf static *.html" trust="true" />
	</target>

	<target name="creat">
		<echo message="creat target dir：${build}" />
		<tstamp />
		<mkdir dir="${build}" />
	</target>

	<target name="copy">
		<echo message="copy files to build：${build}" />
		<copy todir="${build}">
			<fileset dir="${WebSource}">
				<include name="dist/*.*" />
				<include name="dist/*" />
				<exclude name="*.snv/" />
				<exclude name="*.svn/" />
				<exclude name="**/*.bak" />
				<exclude name="build/" />
				<exclude name="build.xml" />
				<exclude name=".project" />
			</fileset>
		</copy>
	</target>
	
	<target name="copy2target">
		<echo message="copy files to target：${target}" />
		<sshexec host="10.163.243.179" port="22" username="root" password="Baiqi@Linux" command="cp -Rf ${build.home} ${target}" trust="true" />
	</target>
</project>